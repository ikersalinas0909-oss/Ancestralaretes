<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Aretes Chulos ‚Äî Cat√°logo & Dise√±ador</title>
<style>
  :root{
    --bg:#fafafc; --fg:#222; --brand:#8a2be2; --brand2:#ff6ec7; --muted:#6b7280; --card:#fff;
    --ring: rgba(138,43,226,.25);
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
    background:linear-gradient(180deg,#fff, var(--bg));
    color:var(--fg);
  }
  header{
    position:sticky; top:0; z-index:10;
    background:#fff; box-shadow:0 2px 18px rgba(0,0,0,.06);
    padding:.75rem 1rem;
  }
  .head-wrap{
    max-width:1100px; margin:0 auto; display:flex; align-items:center; gap:1rem;
  }
  #logoPreview{
    width:64px; height:64px; object-fit:contain; border-radius:12px; border:1px solid #eee; background:#f5f5f7;
  }
  .brand{
    flex:1; text-align:center;
  }
  .brand h1{
    margin:.1rem 0 0; font-size:clamp(1.4rem,3vw,2.2rem);
    background: linear-gradient(90deg, var(--brand), var(--brand2));
    -webkit-background-clip:text; background-clip:text; color:transparent;
    letter-spacing:.5px;
  }
  nav{
    display:flex; gap:.5rem; flex-wrap:wrap; justify-content:center; margin:.35rem 0 .2rem;
  }
  nav a{
    text-decoration:none; color:#444; font-weight:600; padding:.4rem .7rem; border-radius:999px;
  }
  nav a:hover{ background:#f1f1f6 }
  .bar{
    display:flex; gap:.75rem; align-items:center; flex-wrap:wrap; justify-content:center;
  }
  .bar input[type="file"]{
    display:none;
  }
  .btn, label[for]{
    cursor:pointer; border:1px solid #e5e7eb; background:#fff; color:#111; font-weight:600;
    padding:.6rem .9rem; border-radius:12px;
    box-shadow:0 2px 10px rgba(0,0,0,.04);
    transition:transform .12s ease, box-shadow .12s ease, border-color .12s ease;
  }
  .btn:hover, label[for]:hover{ transform:translateY(-1px); box-shadow:0 6px 18px rgba(0,0,0,.08) }
  .btn.primary{
    background:linear-gradient(90deg, var(--brand), var(--brand2)); color:#fff; border-color:transparent;
  }

  main{ max-width:1100px; margin:1.2rem auto; padding:0 1rem; }
  section{ background:var(--card); border:1px solid #edf; border-radius:18px; padding:1.1rem; margin:1rem 0;
    box-shadow:0 8px 28px rgba(138,43,226,.06);
  }
  section h2{
    margin:.2rem 0 1rem; font-size:clamp(1.2rem,2.4vw,1.6rem);
    display:flex; align-items:center; gap:.6rem;
  }
  .hint{ color:var(--muted); font-size:.95rem }
  .grid{
    display:grid; grid-template-columns:repeat(auto-fill, minmax(170px,1fr)); gap:14px;
  }
  .card{
    background:#fff; border:1px solid #eee; border-radius:14px; overflow:hidden; position:relative;
    transition:transform .15s ease, box-shadow .15s ease, border-color .15s ease;
  }
  .card:hover{ transform:translateY(-2px); box-shadow:0 12px 30px rgba(0,0,0,.08); border-color:var(--ring) }
  .card img{ width:100%; display:block; aspect-ratio:1/1; object-fit:cover; background:#f7f7fb }
  .chip{
    position:absolute; top:8px; left:8px; background:rgba(255,255,255,.85);
    padding:.25rem .5rem; border-radius:999px; font-size:.78rem; border:1px solid #eee;
    backdrop-filter: blur(6px);
  }
  .del{
    position:absolute; top:8px; right:8px; border:none; background:#fff; border:1px solid #eee;
    border-radius:999px; width:28px; height:28px; display:grid; place-items:center; cursor:pointer;
  }
  .controls{
    display:grid; grid-template-columns:repeat(auto-fit, minmax(180px,1fr)); gap:.8rem; margin:.6rem 0 1rem;
  }
  .control{
    border:1px dashed #e5e7eb; border-radius:12px; padding:.7rem .8rem; background:#fcfcfe;
  }
  .control label{ display:block; font-size:.9rem; color:#374151; margin-bottom:.35rem; font-weight:600 }
  .control input[type="color"], .control select, .control input[type="range"], .control input[type="number"]{
    width:100%; padding:.4rem .5rem; border:1px solid #e5e7eb; border-radius:10px; background:#fff;
  }
  .designer{
    display:grid; grid-template-columns: 1fr 1fr; gap:1rem; align-items:start;
  }
  canvas{
    width:100%; background:#fff; border:1px solid #eee; border-radius:16px; box-shadow:0 6px 22px rgba(0,0,0,.06);
    aspect-ratio:1/1;
  }
  .tips{ color:#6b7280; font-size:.9rem; margin-top:.4rem }
  .actions{ display:flex; gap:.6rem; flex-wrap:wrap }
  .empty{
    border:2px dashed #e5e7eb; border-radius:16px; padding:2rem; text-align:center; color:#9aa0a6;
  }
  @media (max-width:900px){ .designer{ grid-template-columns:1fr; } .brand{ text-align:center } }
</style>
</head>
<body>
<header>
  <div class="head-wrap">
    <img id="logoPreview" alt="Tu logo" />
    <div class="brand">
      <div class="bar">
        <nav>
          <a href="#catalogo">Cat√°logo</a>
          <a href="#logo">Logo</a>
          <a href="#disenador">Haz tu propio arete</a>
        </nav>
      </div>
      <h1>Aretes Chulos</h1>
    </div>
    <div style="width:64px"></div><!-- spacer para equilibrar -->
  </div>
</header>

<main>
  <!-- LOGO -->
  <section id="logo">
    <h2>üñºÔ∏è Tu logo</h2>
    <p class="hint">Sube tu logotipo para mostrarlo en el encabezado.</p>
    <div class="bar">
      <label for="logoFile">üì§ Subir logo (PNG/JPG)</label>
      <input type="file" id="logoFile" accept="image/*">
      <button class="btn" id="clearLogo">Quitar logo</button>
    </div>
  </section>

  <!-- CAT√ÅLOGO -->
  <section id="catalogo">
    <h2>üß∑ Cat√°logo de aretes</h2>
    <p class="hint">Agrega fotos de tus piezas. Puedes subir varias a la vez.</p>
    <div class="bar" style="margin-bottom:.5rem">
      <label for="catalogInput">üì§ Subir fotos</label>
      <input type="file" id="catalogInput" accept="image/*" multiple>
      <button class="btn" id="clearCatalog">Vaciar cat√°logo</button>
    </div>
    <div id="catalogGrid" class="grid empty">
      <div style="grid-column:1/-1" class="empty">A√∫n no has subido fotos. ¬°Agrega algunas arriba! ‚ú®</div>
    </div>
  </section>

  <!-- DISE√ëADOR -->
  <section id="disenador">
    <h2>üé® Haz tu propio arete</h2>
    <p class="hint">Elige un molde, colores y tama√±o. Descarga tu dise√±o o s√∫belo directo al cat√°logo.</p>

    <div class="designer">
      <div>
        <div class="controls">
          <div class="control">
            <label for="shape">Molde</label>
            <select id="shape">
              <option value="circle">C√≠rculo</option>
              <option value="heart">Coraz√≥n</option>
              <option value="star">Estrella</option>
              <option value="teardrop">Gota</option>
              <option value="square">Cuadrado</option>
            </select>
          </div>
          <div class="control">
            <label for="fill">Color de relleno</label>
            <input type="color" id="fill" value="#ff6ec7">
          </div>
          <div class="control">
            <label for="stroke">Color del borde</label>
            <input type="color" id="stroke" value="#8a2be2">
          </div>
          <div class="control">
            <label for="strokeW">Grosor del borde</label>
            <input type="range" id="strokeW" min="0" max="20" value="6">
          </div>
          <div class="control">
            <label for="size">Tama√±o del dije (px)</label>
            <input type="range" id="size" min="80" max="360" value="220">
          </div>
          <div class="control">
            <label for="hook">Ganchito</label>
            <select id="hook">
              <option value="gold">Dorado</option>
              <option value="silver">Plata</option>
              <option value="none">Sin gancho</option>
            </select>
          </div>
          <div class="control">
            <label for="pattern">Patr√≥n</label>
            <select id="pattern">
              <option value="none">Liso</option>
              <option value="stripes">Rayas</option>
              <option value="dots">Puntos</option>
            </select>
          </div>
          <div class="control">
            <label for="bg">Fondo (vista previa)</label>
            <input type="color" id="bg" value="#ffffff">
          </div>
        </div>
        <div class="actions">
          <button class="btn primary" id="download">Descargar dise√±o</button>
          <button class="btn" id="toCatalog">Agregar al cat√°logo</button>
        </div>
        <p class="tips">Tip: tambi√©n puedes hacer **pares** descargando dos veces o agregando al cat√°logo y duplicando la imagen.</p>
      </div>

      <div>
        <canvas id="canvas" width="800" height="800" aria-label="Vista previa del arete"></canvas>
      </div>
    </div>
  </section>
</main>

<script>
/* ---------- Utilidades ---------- */
const $ = sel => document.querySelector(sel);
const grid = $('#catalogGrid');

/* ---------- Logo ---------- */
const logoInput = $('#logoFile');
const logoImg = $('#logoPreview');
const clearLogo = $('#clearLogo');

logoInput.addEventListener('change', (e)=>{
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = ev => { logoImg.src = ev.target.result; };
  reader.readAsDataURL(file);
});
clearLogo.addEventListener('click', ()=>{
  logoImg.removeAttribute('src');
  logoInput.value = '';
});

/* ---------- Cat√°logo ---------- */
const catalogInput = $('#catalogInput');
const clearCatalog = $('#clearCatalog');

function ensureGridReady(){
  if (grid.classList.contains('empty')){
    grid.classList.remove('empty');
    grid.innerHTML = '';
  }
}

catalogInput.addEventListener('change', (e)=>{
  const files = Array.from(e.target.files || []);
  if(!files.length) return;
  ensureGridReady();
  files.forEach(file=>{
    const reader = new FileReader();
    reader.onload = ev => addCard(ev.target.result, file.name);
    reader.readAsDataURL(file);
  });
  catalogInput.value = '';
});

clearCatalog.addEventListener('click', ()=>{
  grid.innerHTML = '<div style="grid-column:1/-1" class="empty">Cat√°logo vac√≠o. Sube nuevas fotos arriba ‚ú®</div>';
  grid.classList.add('empty');
});

function addCard(src, name='Dise√±o'){
  const card = document.createElement('div');
  card.className = 'card';
  card.innerHTML = `
    <span class="chip">${name.length>18 ? name.slice(0,18)+'‚Ä¶' : name}</span>
    <button class="del" title="Eliminar">‚úï</button>
    <img alt="${name}">
  `;
  card.querySelector('img').src = src;
  card.querySelector('.del').addEventListener('click', ()=> card.remove());
  grid.appendChild(card);
  if (grid.classList.contains('empty')){
    grid.classList.remove('empty');
  }
}

/* ---------- Dise√±ador en Canvas ---------- */
const canvas = $('#canvas');
const ctx = canvas.getContext('2d');

const controls = {
  shape: $('#shape'),
  fill: $('#fill'),
  stroke: $('#stroke'),
  strokeW: $('#strokeW'),
  size: $('#size'),
  hook: $('#hook'),
  pattern: $('#pattern'),
  bg: $('#bg')
};

Object.values(controls).forEach(el => el.addEventListener('input', draw));

function drawHook(cx, topY, color){
  ctx.save();
  ctx.strokeStyle = color;
  ctx.lineWidth = 8;
  ctx.lineCap = 'round';
  // ganchito simple (curva)
  ctx.beginPath();
  ctx.moveTo(cx, topY);
  ctx.quadraticCurveTo(cx-10, topY-30, cx-25, topY-10);
  ctx.stroke();
  // argolla
  ctx.beginPath();
  ctx.lineWidth = 6;
  ctx.arc(cx, topY+14, 10, 0, Math.PI*2);
  ctx.stroke();
  ctx.restore();
}

function patternFill(type, bbox){
  if (type==='none') return;
  ctx.save();
  ctx.clip();
  ctx.globalAlpha = 0.35;
  ctx.lineWidth = 6;
  ctx.strokeStyle = '#000';
  if (type==='stripes'){
    const step = 24;
    for (let x=bbox.x- bbox.h; x<bbox.x+bbox.h; x+=step){
      ctx.beginPath();
      ctx.moveTo(x, bbox.y - bbox.h);
      ctx.lineTo(x + bbox.h*2, bbox.y + bbox.h);
      ctx.stroke();
    }
  } else if (type==='dots'){
    const step = 26;
    for (let y=bbox.y - bbox.h; y<bbox.y + bbox.h; y+=step){
      for (let x=bbox.x - bbox.h; x<bbox.x + bbox.h; x+=step){
        ctx.beginPath();
        ctx.arc(x, y, 4, 0, Math.PI*2);
        ctx.fillStyle = '#000';
        ctx.fill();
      }
    }
  }
  ctx.restore();
}

function drawShape(shape, cx, cy, r){
  ctx.beginPath();
  if (shape==='circle'){
    ctx.arc(cx, cy, r, 0, Math.PI*2);
  } else if (shape==='square'){
    const s = r*1.6;
    ctx.roundRect(cx - s/2, cy - s/2, s, s, 18);
  } else if (shape==='teardrop'){
    // gota: c√≠rculo + tri√°ngulo curvo
    ctx.moveTo(cx, cy - r);
    ctx.bezierCurveTo(cx + r*1.2, cy - r*0.2, cx + r*0.6, cy + r*1.1, cx, cy + r*1.2);
    ctx.bezierCurveTo(cx - r*0.6, cy + r*1.1, cx - r*1.2, cy - r*0.2, cx, cy - r);
  } else if (shape==='heart'){
    const k = r*0.75;
    ctx.moveTo(cx, cy + k*0.9);
    ctx.bezierCurveTo(cx - k*1.6, cy - k*0.3, cx - k*0.6, cy - k*1.3, cx, cy - k*0.4);
    ctx.bezierCurveTo(cx + k*0.6, cy - k*1.3, cx + k*1.6, cy - k*0.3, cx, cy + k*0.9);
  } else if (shape==='star'){
    const spikes=5, outer=r, inner=r*0.45;
    let rot = Math.PI/2 * 3;
    let x=cx, y=cy;
    ctx.moveTo(cx, cy - outer);
    for(let i=0;i<spikes;i++){
      x = cx + Math.cos(rot)*outer; y = cy + Math.sin(rot)*outer; ctx.lineTo(x,y); rot += Math.PI/spikes;
      x = cx + Math.cos(rot)*inner; y = cy + Math.sin(rot)*inner; ctx.lineTo(x,y); rot += Math.PI/spikes;
    }
    ctx.closePath();
  }
}

function draw(){
  const W = canvas.width, H = canvas.height;
  ctx.clearRect(0,0,W,H);

  // fondo
  ctx.fillStyle = controls.bg.value || '#fff';
  ctx.fillRect(0,0,W,H);

  const cx = W/2, cy = H/2 + 40; // un poco m√°s abajo para dejar espacio al gancho
  const size = parseInt(controls.size.value,10);
  const r = size/2;

  // gancho
  if (controls.hook.value!=='none'){
    const hookColor = controls.hook.value==='gold' ? '#c9a227' : '#9aa4b2';
    drawHook(cx, cy - r - 40, hookColor);
  }

  // figura principal
  ctx.save();
  drawShape(controls.shape.value, cx, cy, r);
  ctx.fillStyle = controls.fill.value;
  ctx.fill();

  // patr√≥n
  const bbox = { x: cx, y: cy, h: r*1.6 };
  patternFill(controls.pattern.value, bbox);

  // borde
  const sw = parseInt(controls.strokeW.value,10);
  if (sw>0){
    ctx.strokeStyle = controls.stroke.value;
    ctx.lineWidth = sw;
    ctx.stroke();
  }
  ctx.restore();

  // agujerito del dije (si hay gancho)
  if (controls.hook.value!=='none'){
    ctx.beginPath();
    ctx.fillStyle = '#eee';
    ctx.arc(cx, cy - r + 10, 6, 0, Math.PI*2);
    ctx.fill();
    ctx.strokeStyle = '#ccc'; ctx.lineWidth = 2; ctx.stroke();
  }
}
draw();

/* Descargar PNG */
$('#download').addEventListener('click', ()=>{
  const link = document.createElement('a');
  link.download = 'arete-disenado.png';
  link.href = canvas.toDataURL('image/png');
  link.click();
});

/* Agregar al cat√°logo */
$('#toCatalog').addEventListener('click', ()=>{
  const data = canvas.toDataURL('image/png');
  ensureGridReady();
  addCard(data, 'Dise√±o');
});

/* ---------- Accesibles --------- */
document.addEventListener('keydown', (e)=>{
  if (e.key==='s' && (e.ctrlKey||e.metaKey)){ e.preventDefault(); $('#download').click(); }
});
</script>
</body>
</html>

